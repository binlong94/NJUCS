# 计算机网络：自顶向下方法，第7版

## 复习题和习题参考答案


### 版本时间：2016年12月

本文档包含Jim Kurose和Keith Ross编写的《计算机网络：自顶向下方法（第7版）》复习题和习题的参考答案。这些答案只对指导老师有效。请不要复制或者分发给其他人（即使是其他指导老师）。请不要在公共网络发布任何参考答案。如果有需要，我们很乐意提供此参考答案（最新版）。

声明：这些年来，很多同学和同事帮助我们准备此参考答案。特别感谢Honggang Zhang，Rakesh Kumar，Prithula Dhungel和VijayAnnapureddy。同时也感谢提建议和修正错误的所有读者。

所有材料©1996-2016 由J.F.Kurose 和K.W.Rose提供。版权所有。


# 说明

译者：幽弥狂

时间：2019-10-6

版本：2019.10.06

电话：13812991101

QQ：1768478912

邮箱：1768478912@qq.com

环境：Manjaro Linux 18.1.0+WPS11.1.0.8865+自带公式编辑器+vscode insider version Markdown

1、此参考答案所有内容版权由原作者所有，本人为了方便考研复习提供简体中文版本的翻译。

2、阁下在获取到此文档的同时，应该同时获取到此文档的英文原版PDF。此文档的中文版权归本人所有，提供给需要的人使用。

3、阁下在使用本文档时，不得添加水印、删减或修改内容。

4、当然，以上内容只是说说而已，你如果不遵守，我也不可能顺着网线去打你。

5、如果有侵权（对于原作者）或者其他的问题或者建议，欢迎联系我。

6、阁下在使用本文档时，请保留此页面和原版翻译的封面。

7、根据南京大学计算机845真题的内容，本文档只翻译第1-7章。

# 目录

[第一章](#第一章)
- [复习题](#复习题1)
- [问题](#问题1)

[第二章](#第二章)
- [复习题](#复习题2)
- [问题](#问题2)

[第三章](#第三章)
- [复习题](#复习题3)
- [问题](#问题3)

[第四章](#第四章)
- [复习题](#复习题4)
- [问题](#问题4)

[第五章](#第五章)
- [复习题](#复习题5)
- [问题](#问题5)

[第六章](#第六章)
- [复习题](#复习题6)
- [问题](#问题6)

[第七章](#第七章)
- [复习题](#复习题7)
- [问题](#问题7)

[参考文档](#参考文档)


# 第一章

## 复习题1

1、（1）没有区别。根据书本内容，“主机”和“终端系统”是交换使用的。

（2）终端系统包括PC、工作站、网络服务器、邮件服务器、PDA、连接网络的游戏控制台等等。

（3）由（2）可知，网络服务器是终端系统。

2、来自维基百科：外交协议常用于描述一系列国家来往规则。这些构建完备和经过时间检验的规则可以使国家和人民生活和工作更简单。协议规则以人民准则为基础，其中的一部分已经作为现在分级的地位声明。

3、标准对于协议来说，可以让人们创建可以相互操作的网络系统和产品。

4、（1）通过电话线的拨号调制解调器：家庭

（2）通过电话线的DSL（Digital Subscriber Line，数字用户线）：家庭或小办公室

（3）混合光纤同轴电缆：家庭

（4）100M交换以太网：企业

（5）无线网：家庭或企业

（6）3G和4G：广域无线网

5、HFC带宽是由用户共享。下行通道中，所有的包都是由头端这一个单一源发出的。因此，下行通道中没有碰撞。

6、光纤到户、3G和4G无线网

7、10M、100M、1G、10G

8、双绞线、光纤

9、拨号调制解调器：最高56K，带宽专用
   ADSL：下行最高24M，上行最高2.5M，带宽专用
   HFC：下行最高42.8M，上行最高30.7M，带宽共享
   FTTH：上行2-10M，下行10-20M，带宽不共享

10、现在最流行的无线网技术有两种：

（1）WiFi。用于无线局域网，无线用户从辐射范围为几十米的基站（例如无线接入点）传输数据包。基站连接无线网络，并为无线用户提供无线网服务。

（2）3G和4G。大范围无线网，此系统通过电信服务商提供的基站，由蜂窝电话通过同一个无线设备传输数据。可以提供基站几十千米范围内的无线网络。

11、$t_0$时发送主机开始传输，$t_1=L/R_1$时发送端完成传输并且交换机收到完整的数据包（没有传播延时）。因为交换机在$t_1$时已收到完整包，那么$t_1$时交换机开始传输包至接收主机。$t_2=t_1+L/R_2$时交换机完成输出并且接收主机收到完整包（没有传播延时）。因此，端到端总延时是$L/R_1+L/R_2$。

12、电路交换网络可以在响应时间内保证一定量的端到端带宽。如今大部分分组交换网络（包括因特网）无法保证端到端带宽。FDM需要复杂的模拟硬件来将信号转换为合适的频率。

13、（1）2个用户，每个用户只需要一半的链接带宽；

   （2）既然每个用户传输时要求1Mpbs带宽，如果两个或者更少的用户同时传输，要求最多2Mbps。共享链路的可用带宽是2Mbps，那么传输前没有排队延时。如果有3个用户同时传输，带宽要求是3Mbps，超过了共享链接可用带宽。这种情况下，连接之前会有排队延时。

   （3） 一个用户传输的概率是0.2

   （4）3个用户同时传输的概率是 $\binom{3}{3} p^{3} (1-p)^{3-3}$ 。因为用户传输是队列会增加，队列增加时的时间因素是0.008。

14、如果两个ISP不对等，那么当他们给对方发送流量时他们需要通过一个付费流量ISP提供商（中间商）来发送数据。通过直接对等传输，两个ISP可以减少给其他ISP提供商的费用。多个ISP可以通过网络交换点（IXP）（通常由它自己的交换机单独构建）作为汇合点来直接对等传输。ISP通过对连接至IXP的每一个ISP收取少量费用来盈利，当然利润取决于IXP发送或接收的流量数。

15、谷歌的私有网络连接了它大大小小的所有的数据中心。谷歌数据中心的流量通过它的私有网络而不是公共网络来传输。大多数的数据中心位于或靠近与低级的ISP。因此，当谷歌向用户分发数据时，可以跳过高级的ISP。是什么推动着这些内容提供商创建这些网络？首先，如果内容提供商使用更少的中间的ISP，它可以更容易控制用户体验。其次，通过减少至提供商的网络流量来节省成本。第三，如果ISP向利润率高的内容提供商收取高费用（在网络中立状态不适用的国家或地区），内容提供商可以避免额外成本。

16、延迟组件包括处理延迟、传输延迟、传播延迟、排队延迟。除了排队延迟是变量其他的都是固定的。

17、a）1000km, 1Mpbs, 100bytes
   b）100km, 1Mpbs, 100bytes

18、（1）10msec
   （2）d/s
   （3）无关
   （4）无关

19、(1) 500kps
   (2) 64 seconds
   (3) 100kps；

20、终端系统A将大文件拆分为块。A通过添加文件头信息至每一个块来从文件生成多个数据包。数据包的头信息包含目标（终端系统B）IP地址。数据包交换机通过包中的目标IP地址来决定发送链接。考虑到包目标地址，包选择哪条路走和包选择哪条外链走的方法相似。

21、最大发送速率为500包/s，最大传输速率是350包/s。相对应的话务量强度是500/350=1.43>1。每次实验最终都会发生数据丢失；由于传输的随机性，每一次实验的数据丢失发生的时间都是不同的。

22、五个功能是：错误控制、流控制、片段化和重组、多任务和连接设置。没错，在不同层这些功能可能重复。例如，不止一层提供错误功能。

23、网络协议的自顶向下的五层是：应用层、传输层、网络层、链路层和物理层。详见1.5.1。

24、应用层报文：应用程序想发送和通过传输层的数据；

   传输层段：由传输层生成并且封装有传输层头信息的应用层报文

   网络层数据段：封装有网络层头信息的传输层段

   链路层帧：封装有链路层头信息的网络层数据段

25、路由器处理网络、链路、物理层（第1到3层）。（实际上现代路由器有时担任防火墙、缓存组件和处理传输层）链路层交换机处理链路层和网络层（第1到2层）。主机处理所有的五层。

26、a）病毒

   需要以下人的交互来传播。比如邮件病毒。

   b）蠕虫

   不需要用户介入。受感染主机中的蠕虫会扫描IP地址和端口号来查找可感染的进程。

27、创建僵尸网络需要攻击者发现以下应用或系统的薄弱点（比如利用应用中可能存在的缓冲区溢出漏洞）。发现薄弱点后，黑客需要查找可攻击的主机。目标一般是已发现漏洞的一系列系统。僵尸网络中的任何系统都可以通过漏洞自动扫描它的环境和传播。这种僵尸网络的重要属性就是僵尸网络的起点可以远程控制和发送命令至僵尸网络中的所有结点的每一个节点（例如僵尸网络中的所有结点可以被黑客命令发送TCP SYN信息至目标，并将导致目标的TCP SYN溢出攻击）。

28、Trudy可以假装为Bob（反之亦然）并且部分或者完全修改Bob发送给Alice的信息。例如，她可以很容易的修改语句“Alice，我欠你1000美元”为“Alice，我欠你10000美元”。更进一步，Trudy甚至可以丢弃Bob发送给Alice的加密信息（反之亦然）。

[Back to Index](#目录)

## 问题1

P1. 这个问题不止一个答案。很多协议都可以解决这个问题。下面是一个简单的答案：

| Msg name | purpose |
|--------- |-------- |
|HELO <userid> | Let server know that there is a card in the ATM machine . ATM card transmits user ID to Server |
|PASSWD <passwd> | User enters PIN, which is sent to server . BALANCE User requests balance |
|WITHDRAWL <amount> | User asks to withdraw money . BYE user all done |

从服务器至ATM机器的信息（显示）

| Msg name | purpose |
|--------- |-------- |
|PASSWD | Ask user for PIN (password) |
|OK | last requested operation (PASSWD, WITHDRAWL) OK |
|ERR | last requested operation (PASSWD, WITHDRAWL) in ERROR |
|AMOUNT <amt> | sent in response to BALANCE request |
|BYE | user done, display welcome screen at ATM |

正确回应：

|client | server |
|-------|--------|
|HELO (userid) | --------------> (check if valid userid) |
| | <------------- PASSWD |
|PASSWD <passwd> | --------------> (check password) |
| | <------------- OK (password is OK) |
|BALANCE |--------------> 
| | <------------- AMOUNT <amt> |
|WITHDRAWL <amt> | --------------> check if enough $ to cover withdrawl |
| | <------------- OK |
|ATM dispenses $ 
|BYE | --------------> |
| | <------------- BYE |

钱不够的情况下：

|client | server |
|-------|--------|
|HELO (userid) |--------------> (check if valid userid) |
| |<------------- PASSWD |
|PASSWD <passwd> |--------------> (check password) |
|| <------------- OK (password is OK) |
|BALANCE |--------------> |
|| <------------- AMOUNT <amt> |
|WITHDRAWL <amt> |--------------> check if enough $ to cover |
withdrawl ||
| |<------------- ERR (not enough funds) |
|error msg displayed ||
|no $ given out ||
|BYE |--------------> |
| | <------------- BYE|

P2. N*(L/R)时，第一个包到达目的地，第二个包存储在最后一个路由器中，第三个包存储在倒数第二个路由器中，等等。N*(L/R)+L/R时，第二个包到达目的地，第三个包存储在最后一个路由器中，等等。按照这个逻辑继续，我们可以看到在N*(L/R)+(P-1)*(L/R)=(N+P-1)*(L/R)时所有数据包到达目的地。

P3.

a.电路交换网，因为应用将以稳定速率，持续长时间运行，因此可以为其保留带宽。

b.不需要，传输速率总和小于链路容量。

P4.

a.在左上角的开关和右上角的开关之间，我们可以有4个连接。类似地，我们可以在其他3对相邻开关之间各有四个连接。因此，这个网络可以支持多达16个连接。

比如：

A 到 B ：4 条

B 到 C ：4 条

C 到 D ：4 条

D 到 A ：4 条

这 16 条可以同时连接。

b.我们可以通过右上角的开关通过4个连接，在左下角有4个通过开关的连接，总共有8个连接。

A 到 B ：4 条

B 到 C ：4 条

最多 8 条。

c.可以。对于A和C之间的连接，我们路由两个连接通过B，两个连接通过D。对于B和D之间的连接，我们路由两个连接通过A，两个连接通过C。这样，最多有4个连接通过任何链接。

A 到 B ：2 条

B 到 A ：2 条

A 到 D ：2 条

B 到 C ：2 条

P5.收费亭相距75公里，车辆以每小时100公里的速度传播。收费亭每12秒为一辆汽车提供服务。

a.有十辆车。第一个收费站服务这10辆车需要120秒钟，也就是2分钟。每辆汽车在到达第二个收费站之前都有45分钟的传播延迟(行驶75公里)。因此，在47分钟后的第二个收费站前，所有的汽车都排好了队。整个过程重复在第二个和第三个收费亭之间旅行。第三个收费站还需要2分钟才能为10辆车提供服务。因此，总的延迟时间是96分钟。

收费站将整个车队推向公路的时间为 d1 = 2min；

两收费站之间距离 75 km，从一个收费站到另一个的时间 d2 = 0.75 h

总时间 d = 3d1 + 2d2 = 96min

b.收费亭之间的延误为8*12秒加上45分钟，即46分钟和36秒。总延迟是这一数额的两倍，加上8*12秒，即94分48秒。

d1’ = 8辆 / 5辆/min = 1.6min

d’ = 3d1’ + 2d2 = 94.8min

P6.

a.$d_{prop}=m/s seconds$

b.$d_{trans}=L/R seconds$

c.$d_{e2e}=d_{prop}+d_{trans}=m/s+L/R$

d.刚刚离开A

e.第一位在链路上并且还没有到达B

f.已经到达B

g.
$d_{prop}$ = $d_{trans}$

m/s = L/R

m = Ls/R = 120b * (2.5 *10^8)m/s / 56kbps = (5.36 * 10^5)m

P7.
考虑数据包中的第一位。在传输此位之前，必须生成数据包。

主机 A 产生 56 字节的分组需要 = 56 * 8b / 64kbps = 7ms

传输时延 = 56 * 8b / 2Mbps = 0.224ms

总时间 = 7ms + 10ms + 0.224ms = 17.224ms

P8.

a.3Mbps/150kbps = 20

b.p = 0.1

c.

$(120n)pn(1−p)120−n$

(n120​)pn(1−p)120−n

d.

1−∑20n=0(120n)pn(1−p)120−n

1−∑n=020​(n120​)pn(1−p)120−n

根据中心极限定理：
令$X_j$为独立随机变量P($X_j$​=1)=p ；

P(21或更多用户)=1−P(∑120i=1Xi≤21)P(21或更多用户)=1−P(∑i=1120​Xi​≤21)
P(∑120i=1Xi≤21)=P(∑120i=1Xi≤12120∗0.1∗0.9√≤9120∗0.1∗0.9√)≈P(Z≤93.286)=P(Z≤2.74)=0.997P(∑i=1120​Xi​≤21)=P(120∗0.1∗0.9
​∑i=1120​Xi​≤12​≤120∗0.1∗0.9
​9​)≈P(Z≤3.2869​)=P(Z≤2.74)=0.997
因此 P(21或更多用户)≈0.003

P(21或更多用户)≈0.003

P9.

a.
N=1Gbps100kbps=10_4

b.
∑Mn=N+1(Mn)pn(1−p)M−n

P10.

Dtrans=L/R1+L/R2+L/R3

Dprop=d1/s1+d2/s2+d3/s3

Dprop=2∗dprocDprop=2∗dproc

D=Dtrans+Dprop+Dproc

D=6+6+6+20+16+4+3+3=64ms

P11.

D=Dprop+L/R=20+16+4+6=46ms

P12.

有一个完整分组的排队时延为 1500∗8b2Mbps=0.6ms
2Mbps1500∗8b​=0.6ms

4.5个分组的总排队时延为 4.5∗0.6ms=2.7ms

4.5∗0.6ms=2.7ms

一般情况：LnR+L−xR

P13.

a.
第一个分组的排队时延为 0, 第二个 L/R, 第三个 2L/R，第N个 (N-1)L/R

因此平均排队时延为 (L/R + 2L/R + … + (N-1)L/R) / N = (N-1)L/2R

b.当下一批 N 个分组到达时，上一批已经传完，因此平均排队时延为 (N-1)L/2R

P14.

a.
IL/R(1-I) + L/R = L/R(1-I)

b.
以 L/R 为函数：

令 x = L/R： L/R(1-I) = x/(1-ax)

函数经过原点，在 x = 1/a 处趋于无穷

P15.

μ = R/L 所以 L / R(1-I) = 1 / μ-a

P16.

N = 10 + 1 = 11个分组

d = 10ms + 1/100s = 0.02s

a = N/d = 11/0.02 = 550分组/s

P17.

a.设有 N - 1 台路由器，则 de2e=∑Ni=1diproc+diprop+ditrans

de2e​=∑i=1N​dproci​+dpropi​+dtransi​

b.
de2e=∑Ni=1diproc+diprop+ditrans+diqueue

de2e​=∑i=1N​dproci​+dpropi​+dtransi​+dqueuei​

P18.

略

P19.

略

P20.

min{Rs, Rc, R/M}

P21.

仅使用一条：
max{min{R11,R12,...,R1N},min{R21,R22,...,R2N},...min{RM1,RM2,...,RMN}}

max{min{R11​,R21​,...,RN1​},min{R12​,R22​,...,RN2​},...min{R1M​,R2M​,...,RNM​}}

使用 M 条：
∑Mk=1min{Rk1,Rk2,...,RkN}

∑k=1M​min{R1k​,R2k​,...,RNk​}
P22.

不丢包概率为 1 - p， N 个路由器， 因此总的不丢包概率 (1−p)N
(1−p)N
一个分组被接收所需要的平均次数为 1(1−p)N(1−p)N1​，因此重传次数为 1(1−p)N−1

(1−p)N1​−1
P23.

a.
L/Rs

b.
可能，因为第二个分组 (用 P2 表示) 可能在第一个分组 (P1) 被推出之前到达；

P1 被完全推出的时间 t1 = L/Rs + L/Rc + dprop
P2 到达路由器的时间 t2 = 2L/Rs + dprop + T
要求 t2 > t1:
                  即 T > L/Rc - L/Rs；
因此 T 至少是 L/Rc - L/Rs
P24.

t = 40 * 10^12 * 8b / 100Mbps = 3.2 * 10^6 s = 888h = 37 天
所以使用 FedEx
P25.

a.
tprop = 20000km / 2.5*10^8m/s = 0.08s
R * tprop = 1.6 * 10^5 b

b.
1.6 * 10^5 b

c.
链路上的最大比特数量

d.
20000km / 1.6*10^5 = 125m
这比足球场长(正规足球场场地：长105米、宽68米)

e.
s/R
P26.

s/R = 20000km
R = 12.5Mbps
P27.

a.
R * dprop = 8 * 10^7 b

b.
8 * 10^7 b 是 不对 的，因为文件为 8 * 10^5 b，因此为 8 * 10^5 b

c.
s/R = 0.25m
P28.

a.
ttrans + tprop = 0.48s

b.
20 * (ttrans’ + tprop) = 20 * (0.02 + 0.08)s = 2s

c
(b)花的时间更长
P29.

a.
dprop = 36000km / (2.4 * 10^8) = 0.15s

b.
R * dprop = 10Mbps * 0.15s = 1.5 * 10^6 b

c.
60s * 10Mbps = 6 * 10^8 b
P30.

有，略
P31.

a.
8 * 10^6 / 2Mbps = 4s
3 * 4s= 12s

b.
1 * 10^4 b / 2Mbps = 5 * 10^(-3)s
5 * 10^(-3)s
5 * 10^(-3)s
2 * 5 * 10^(-3)s = 10^(-2)s

c.
(800 + 3 - 1) * 0.5 * 10^(-2) = 4.01s
比 (a) 快非常多

d.
便于检测错误并重传；不分段的大包容易使路由器缓存不足导致丢包；

e.
分组需要排序；需加上首部信息；
P32.

略
P33.

D = (3 + F/S - 1) * (80 + R) /R = (2 + F/S)(80 + S) / R
ddSD=0
dSd​D=0 因此 S=40F−−−−√S=40F

​
P34.

略

[Back to Index](#目录)

# 第二章

## 复习题2

[Back to Index](#目录)

## 问题2

[Back to Index](#目录)

# 第三章

## 复习题3

[Back to Index](#目录)

## 问题3 

[Back to Index](#目录)

# 第四章

## 复习题4 

[Back to Index](#目录)

## 问题4 
















P14、每个片段中数据字段的最大大小=680(因为有20个字节的IP报头)。因此，所需的片段数$\left \lceil \frac{2400-20}{680} \right \rceil =4$。每个片段将具有识别号422。除最后一个片段外，每个片段的大小为700个字节(包括IP报头)。最后一个数据报的大小为360字节(包括IP报头)。这4个片段的偏移量为0，85，170，255。前三个片段中的每一个都有标志=1；最后一个片段将有标志=0。

P15、MP3文件大小=500万字节。假设数据是在TCP段中携带的，每个TCP段也有20个字节的标头。然后，每个数据报可以携带1500-40=1460字节的MP3文件。

需要的数据报数为$\left \lceil 
\frac{5 \times 10^6}{1460}
\right \rceil$=3425。除了最后一个数据报之外，所有的数据报都是1500字节；最后的数据报是960+40=1000字节。注意，这里没有碎片--源主机不会创建大于1500个字节的数据报，并且这些数据报小于链接的MTU。

P16、

a) 家庭地址：192.168.1.1、192.168.1.2、192.168.1.3，路由器接口为192.168.1.4

b) 
|NAT Translation Table ||
|-|-|
|WAN Side |LAN Side |
|24.34.112.235, 4000 |192.168.1.1, 3345 |
|24.34.112.235, 4001 |192.168.1.1, 3346 |
|24.34.112.235, 4002 |192.168.1.2, 3445 |
|24.34.112.235, 4003 |192.168.1.2, 3446 |
|24.34.112.235, 4004 |192.168.1.3, 3545 |
|24.34.112.235, 4005 |192.168.1.3, 3546 |


P17、

(A)由于所有IP数据包都发送到外部，所以我们可以使用数据包嗅探器记录NAT后面的主机生成的所有IP数据包。由于每个主机都生成一个具有序列号的IP数据包序列，并且有一个不同的(很可能是从一个大空间中随机选择的)初始标识号(ID)，因此我们可以将具有连续ID的IP数据包分组到一个集群中。集群的数量是NAT背后的主机数量。

有关更多实用算法，请参阅以下论文。

“A Technique for Counting NATted Hosts”, by Steven M. Bellovin, appeared in 
IMW’02, Nov. 6-8, 2002, Marseille, France. 

“Exploiting the IPID field to infer network path and end-system characteristics.” 
Weifeng Chen, Yong Huang, Bruno F. Ribeiro, Kyoungwon Suh, Honggang Zhang, 
Edmundo de Souza e Silva, Jim Kurose, and Don Towsley. 

PAM'05 Workshop, March 31 - April 01, 2005. Boston, MA, USA. 


b)但是，如果这些识别号码不是按顺序分配的，而是随机分配的，则(A)部分中所建议的技术将无法工作，因为在嗅探数据中不会出现集群。

P18、想出这样的技术是不可能的。为了在Arnold和Bernard之间建立一个直接的TCP连接，Arnold或Bob必须启动到另一个连接。但是覆盖Arnold和Bob的NAT丢弃了从WAN端到达的SYN数据包。因此，无论是Arnold还是Bob，如果它们都落后于NAT，就无法启动到对方的TCP连接。

P19、

|S2 Flow Table ||
|-|-------------|
|Match |Action |
|Ingress Port = 1; IP Src = 10.3.*.*; IP Dst = 10.1.*.* |Forward (2) |
|Ingress Port = 2; IP Src = 10.1.*.*; IP Dst = 10.3.*.* |Forward (1) |
|Ingress Port = 1; IP Dst = 10.2.0.3 |Forward (3) |
|Ingress Port = 2; IP Dst = 10.2.0.3 |Forward (3) |
|Ingress Port = 1; IP Dst = 10.2.0.4 |Forward (4) |
|Ingress Port = 2; IP Dst = 10.2.0.4 |Forward (4) |
|Ingress Port = 4 |Forward (3) |
|Ingress Port = 3 |Forward (4)|

P20、

|S2 Flow Table ||
|-|-------------|
|Match |Action |
|Ingress Port = 3; IP Dst = 10.1.*.* |Forward (2) |
|Ingress Port = 3; IP Dst = 10.3.*.* |Forward (2) |
|Ingress Port = 4; IP Dst = 10.1.*.* |Forward (1) |
|Ingress Port = 4; IP Dst = 10.3.*.* |Forward (1) |

P21、

|S1 Flow Table ||
|-|-------------|
|Match |Action |
|IP Src = 10.2.*.*; IP Dst = 10.1.0.1 |Forward (2) |
|IP Src = 10.2.*.*; IP Dst = 10.1.0.2 |Forward (3) |
|IP Src = 10.2.*.*; IP Dst = 10.3.*.* |Forward (1) |

|S3 Flow Table ||
|-|-------------|
|Match |Action |
|IP Src = 10.2.*.*; IP Dst = 10.3.0.6 |Forward (1) 
|IP Src = 10.2.*.*; IP Dst = 10.3.0.5 |Forward (2) 
|IP Src = 10.2.*.*; IP Dst = 10.1.*.* |Forward (3) |


P22、

| S2 Flow Table||
|-|-------------| 
|Match | Action |
|IP Src = 10.1.0.1; IP Dst = 10.2.0.3 |Forward (3) |
|IP Src = 10.1.0.1; IP Dst = 10.2.0.4 | Forward (4) |
|IP Src = 10.3.0.6; IP Dst = 10.2.0.3 |Forward (3) |
|IP Src = 10.3.0.6; IP Dst = 10.2.0.4 |Forward (4) |

|S2 Flow Table ||
|--|--|
|Match |Action| 
|IP Src =.*.*.*.*; IP Dst = 10.2.0.3; port = TCP |Forward (3) |
|IP Src =.*.*.*.*; IP Dst = 10.2.0.4; port = TCP |Forward (4) |


|S2 Flow Table| |
|--|--|
|Match |Action |
|IP Src =.*.*.*.*; IP Dst = 10.2.0.3 |Forward (3) |

|S2 Flow Table| |
|--|--|
|Match |Action |
|IP Src = 10.1.0.1; IP Dst = 10.2.0.3; port = UDP |Forward (3) |

[Back to Index](#目录)

# 第五章

## 复习题5

R1、每个路由器控制意味着一个路由算法在每个路由器中运行；转发和路由功能在每个路由器内都受到约束。每个路由器都有一个路由组件，它与其他路由器中的路由组件通信，以计算其转发表的值。在这种情况下，我们说网络控制和数据平面是以单一方式实现的，因为每个路由器作为一个独立的实体来实现自己的控制和数据平面。

R2、逻辑集中控制是指逻辑中央路由控制器计算和分配每个路由器使用的转发表，而每个路由器不计算其转发表，这与每个路由器控件不同。在逻辑集中控制的情况下，数据平面和控制平面在单独的设备中实现；控制平面在中央服务器或多个服务器上实现，数据平面在每个路由器中实现。

R3、集中式路由算法通过使用关于网络的完整的全局知识来计算源和目的地之间的最小成本路径。该算法需要对所有节点之间的连通性和所有链路的代价有完整的了解。实际计算可以在一个站点上运行，也可以在每个路由器的路由组件中复制。一种分布式路由算法通过路由器以迭代的、分布式的方式计算租赁成本路径.使用分散算法，任何节点都没有关于所有网络链路成本的完整信息。每个节点开始时只知道自己直接连接链路的成本，然后通过与其相邻节点进行计算和信息交换的迭代过程，节点逐渐计算出到达目的地或一组目的地的最小成本路径。

OSPF协议是集中式路由算法的一个例子，BGP协议是分布式路由算法的一个例子。

R4、链路状态算法：使用完整的、全局的网络知识来计算源和目的地之间的最小成本路径。距离向量路由：最小成本路径的计算是以迭代的、分布式的方式进行的。节点只知道它应该向其转发数据包的邻居，以便沿着成本最低的路径到达给定的目的地，以及该路径从自身到目的地的成本。

R5、计数-无穷大问题是指距离矢量路由的问题。所需的问题意味着需要很长的时间用于距离矢量路由算法,当链路成本增加时收敛。例如，考虑三个网络节点X、Y和Z。最初假定链路代价是C(x，y)＝4，c(x，z)＝50，并且C(y，z)＝1。距离矢量路由算法的结果是Z的X的路径是Z→Y→X，成本为5(＝4+1)。当链路(x,y)的成本从4增加到60时,它将花费44次迭代来运行节点Z的距离矢量路由算法,实现其对X的新的最小成本路径通过其直接链路到X，因此Y也将通过Z实现对X的最低成本路径。

R6、没有。每个AS都具有在AS中路由的管理自主权。

R7、政策：在屁股中，政策问题占主导地位。重要的是，源自给定的流量不能通过另一个特定的AS。类似地，一个给定的可能想要控制它在其他驴之间的过境流量。在AS内部，所有事物名义上都处于相同的管理控制之下，因此政策在选择路线方面所起的作用要小得多。

规模：路由算法及其数据结构处理大量网络路由的能力是跨网络路由中的一个关键问题。在AS中，可伸缩性不太受关注。首先，如果单个管理域变得太大，则始终可以将其划分为两个ASS，并在两个新ASS之间执行互选路由。

性能：由于路由非常面向策略，所以使用的路由的质量(例如性能)往往是次要关注的(也就是说，满足某些策略标准的较长或更昂贵的路由很可能被选择在较短但不符合该标准的路由上)。事实上，我们看到，在驴中，甚至没有与路线相关的成本(除了作为跳数)的概念。然而，在一个单一的地方，这种策略关注点就不那么重要了，这使得路由能够更多地关注在路由上实现的性能水平。

R8、假的。

使用ospf，路由器将其链路状态信息广播到它所属的自治系统中的所有其他路由器，而不仅仅是它的邻近路由器。这是因为使用OSPF，每个路由器都需要构造一个完整的AS拓扑图，然后本地运行Dijkstra的最短路径算法来确定它对所有其他节点的最小代价路径。

R9、OSPF自治系统中的一个区域是指一组路由器，其中每个路由器向同一组中的所有其他路由器广播其链路状态。OSPF可以分层配置成多个区域，每个区域运行自己的OSPF链路状态路由算法。在每个区域内，一个或多个区域边界路由器负责在区域外路由数据包。基于扩展性的考虑，引入了Area的概念，即我们希望为大规模OSPF建立分层路由，而区域是分层路由的重要组成部分。

R10、子网是较大网络的一部分；子网不包含路由器；其边界由路由器和主机接口定义。前缀是CDIR地址的网络部分；它以A.B.C.D/x形式写成；前缀包括一个或多个子网。当路由器在BGP会话中通告前缀时，它在前缀中包含许多BGP属性。在BGP术语中，前缀及其属性是BGP路由(或简单地说是路由)。

R11、路由器使用AS-Path属性来检测和防止循环广告；它们还使用它在多个路径中选择相同的前缀。下一跳属性表示沿通告路径的第一个路由器的IP地址(在接收到广告的外部)到给定的前缀。配置时配置它的转发表，路由器使用下一跳属性。

R12、第1级ISP B可能不会携带其他两个一级ISP之间的过境流量，例如A和C，B与它们有对等协议。为了执行这一政策，ISP B不会向通过C的A路做广告，也不会向经过A的C路做广告。

R13、假的。

BGP路由器可以选择不将自己的标识添加到接收到的路径中，然后将新路径发送到其所有邻居，因为bgp是一种基于策略的路由协议。在下面的场景中可能会发生这种情况。接收路径的目的地是其他路径，而不是BGP路由器的AS，而BGP路由器不想充当传输路由器。

R14、通信层通过OpenFlow等协议负责SDN控制器与受控网络设备之间的通信。通过这一层，SDN控制器控制远程SDN启用交换机、主机或其他设备的操作，并且设备将本地观察到的事件(例如，指示链路故障的消息)与控制器通信。

网络范围的状态管理层提供关于网络主机、链路、交换机和其他SDN控制设备的最新信息.控制器还维护各种受控设备的流表的副本。

网络控制应用层代表SDN控制平面的大脑.该层的应用程序使用SDN控制器提供的API来指定和控制网络设备中的数据平面。例如，路由网络控制应用程序可能确定源和目的地之间的端点路径.另一个网络应用程序可能执行访问控制。

R15、我将在SDN的网络控制应用层实现一个新的路由协议，因为这是一个路由协议决定源和目的地之间端到端路径的层。

R16、下面是通过SDN控制器从控制器南行到被控制设备的消息类型的列表。这些消息的接收方是一个受控的数据包交换机。

- 配置。此消息允许控制器查询和设置交换机的配置参数。
- 修改-状态。控制器使用此消息添加/删除或修改交换机流表中的条目，并设置开关端口属性。
- 阅读状态。此消息由控制器用于从交换机的流表和端口收集统计信息和计数器值。
- 发送包。此消息由控制器用于发送特定的数据包在受控开关上的指定端口。

网络控制应用程序(作为发送者)也会通过北向接口向控制器发送消息，例如，在控制器的状态管理层中读取/写入网络状态和流表的消息。

R17、从受控设备到控制器的两种消息类型：

- 流删除消息.它的目的是通知控制器，流表项已被删除，例如，通过超时或接收到的修改状态消息的结果。

- 端口-状态消息.其目的是将港口状态的变化通知控制器。

从控制器到受控设备的两种消息类型：

- 修改-状态。其目的是添加/删除或修改交换机流表中的条目，并设置开关端口属性。

- 读状态。其目的是收集统计数据和计数器值，以查询交换机的流表和端口。

R18、服务抽象层允许内部网络服务应用程序相互通信。它允许控制器组件和应用程序相互调用对方的服务，并订阅它们生成的事件。该层还为通信层中特定的底层通信协议(包括OpenFlow和SNMP)提供了统一的抽象接口。

R19、

Echo回复（至Ping），类型0，代码0

目标网络不可达，类型3，代码0

目标主机不可达，类型3，代码1。

源抑制（拥塞控制），类型4代码0。

R20、ICMP警告消息(类型11代码0)和无法到达的目标端口ICMP消息(类型3代码3)。

R21、管理服务器是一个应用程序，通常有一个人在循环中，运行在网络操作中心的集中网络管理站中。它控制网络管理信息的收集、处理、分析和/或显示。在管理服务器中启动操作以控制网络行为，网络管理员使用管理服务器与网络设备交互。

托管设备是驻留在托管网络上的一段网络设备(包括其软件)。托管设备可能是主机、路由器、交换机、中间盒、调制解调器、温度计或其他网络连接的设备.

网络管理代理是在托管设备中运行的进程，该进程与管理服务器通信，在管理服务器的命令和控制下在托管设备上采取本地操作。

管理信息库(MIB)收集与托管网络中的那些托管对象相关联的信息。MIB对象可以是计数器，例如由于IP数据报报头中的错误而丢弃在路由器上的IP数据报的数量，或者在主机上接收到的UDP段的数量，或者诸如特定设备是否正常工作的状态信息。

R22、GetRequest是从管理服务器发送给代理的消息，用于在代理的托管设备上请求一个或多个MIB对象的值。SetRequest是管理服务器用于在托管设备中设置一个或多个MIB对象的值的消息。

R23、SNMP陷阱消息是作为对设备的管理服务器需要通知的托管设备上发生的事件的响应而生成的。它用于将导致MIB对象值更改的异常情况(例如，向上或向下的链接接口)通知管理服务器。

[Back to Index](#目录)

## 问题5

P1、

y-x-u,y-x-v-u,y-x-w-u,y-x-w-v-u,

y-w-u,y-w-v-u,y-w-x-u,y-w-x-v-u,y-w-v-x-u,

y-z-w-u,y-z-w-v-u,y-z-w-x-u,y-z-w-x-v-u,y-z-w-v-x-u,

P2、

x to z:

x-y-z,x-y-w-z,

x-w-z,x-w-y-z,

x-v-w-z,x-v-w-y-z,

x-u-w-z,x-u-v-w-u-z

x-u-v-w-z,x-u-v-w-y-z

z to u:

z-w-u,

z-w-v-u,z-w-x-u,z-w-v-x-u,z-w-x-v-u,z-w-y-x-u,z-w-y-x-v-u,

z-y-x-u,z-y-x-v-u,z-y-x-w-u,z-y-x-w-y-u,z-y-x-v-w-u,

z-y-w-v-u,z-y-w-x-u,z-y-w-v-x-u,z-y-w-x-v-u,z-y-w-y-x-u,z-y-w-y-x-v-u

z to w:

z-w,z-y-w,z-y-x-w,z-y-x-v-w,z-y-x-u-w,z-y-x-u-v-w,z-y-x-v-u-w


P3、

|step|$N^{'}$|D(t),p(t)|D(u),p(u)|D(v),p(v)|D(w),p(w)|D(y),p(y)|D(z),p(z)|
|-|-|-|-|-|-|-|-|
|0|x|$\infty$|$\infty$|3,x|6,x|6,x|8,x|
|1|xv|7,v|6,v|3,x|6,x|6,x|8,x|
|2|xvu|7,v|6,v|3,x|6,x|6,x|8,x|
|3|xvuw|7,v|6,v|3,x|6,x|6,x|8,x|
|4|xvuwy|7,v|6,v|3,x|6,x|6,x|8,x|
|5|xvuwyt|7,v|6,v|3,x|6,x|6,x|8,x|
|6|xvuwytz|7,v|6,v|3,x|6,x|6,x|8,x|

P4、

a)

|step|$N^{'}$|D(x),p(x)|D(u),p(u)|D(v),p(v)|D(w),p(w)|D(y),p(y)|D(z),p(z)|
|-|-|-|-|-|-|-|-|
|0|x|$\infty$|2,t|4,t|$\infty$|7,t|$\infty$|
|1|xv|$\infty$|2,t|4,t|5,u|7,t|$\infty$|
|2|xvu|7,v|2,t|4,t|5,u|7,t|$\infty$|
|3|xvuw|7,v|2,t|4,t|5,u|7,t|$\infty$|
|4|xvuwy|7,v|2,t|4,t|5,u|7,t|15,x|
|5|xvuwyt|7,v|2,t|4,t|5,u|7,t|15,x|
|6|xvuwytz|7,v|2,t|4,t|5,u|7,t|15,x|

b)

|step|$N^{'}$|D(x),p(x)|D(t),p(t)|D(v),p(v)|D(w),p(w)|D(y),p(y)|D(z),p(z)|
|-|-|-|-|-|-|-|-|
|0|x|$\infty$|2,u|3,u|3,u|$\infty$|$\infty$|
|1|xv|$\infty$|2,u|3,u|3,u|9,t|$\infty$|
|2|xvu|6,v|2,u|3,u|3,u|9,t|$\infty$|
|3|xvuw|6,v|2,u|3,u|3,u|9,t|$\infty$|
|4|xvuwy|6,v|2,u|3,u|3,u|9,t|14,x|
|5|xvuwyt|6,v|2,u|3,u|3,u|9,t|14,x|
|6|xvuwytz|6,v|2,u|3,u|3,u|9,t|14,x|

c)

|step|$N^{'}$|D(x),p(x)|D(u),p(u)|D(t),p(t)|D(w),p(w)|D(y),p(y)|D(z),p(z)|
|-|-|-|-|-|-|-|-|
|0|v|3,v|3,v|4,v|4,v|8,v|$\infty$|
|1|vx|3,v|3,v|4,v|4,v|8,v|11,x|
|2|vxu|3,v|3,v|4,v|4,v|8,v|11,x|
|3|vxut|3,v|3,v|4,v|4,v|8,v|11,x|
|4|vxutw|3,v|3,v|4,v|4,v|8,v|11,x|
|5|vxutwy|3,v|3,v|4,v|4,v|8,v|11,x|
|6|vxutwyz|3,v|3,v|4,v|4,v|8,v|11,x|

d)

|step|$N^{'}$|D(x),p(x)|D(u),p(u)|D(v),p(v)|D(t),p(t)|D(y),p(y)|D(z),p(z)|
|-|-|-|-|-|-|-|-|
|0|w|6,w|3,w|4,w|$\infty$|$\infty$|$\infty$|
|1|wu|6,w|3,w|4,w|5,u|$\infty$|$\infty$|
|2|wuv|6,w|3,w|4,w|5,u|12,v|$\infty$|
|3|wuvt|6,w|3,w|4,w|5,u|12,v|$\infty$|
|4|wuvtx|6,w|3,w|4,w|5,u|12,v|14,x|
|5|wuvtxy|6,w|3,w|4,w|5,u|12,v|14,x|
|6|wuvtxyz|6,w|3,w|4,w|5,u|12,v|14,x|

e)

|step|$N^{'}$|D(x),p(x)|D(u),p(u)|D(v),p(v)|D(w),p(w)|D(t),p(t)|D(z),p(z)|
|-|-|-|-|-|-|-|-|
|0|y|6,y|$\infty$|8,y|$\infty$|7,y|12,y|
|1|yx|6,y|$\infty$|8,y|12,x|7,y|12,y|
|2|yxt|6,y|9,t|8,y|12,x|7,y|12,y|
|3|yxtv|6,y|9,t|8,y|12,x|7,y|12,y|
|4|yxtvu|6,y|9,t|8,y|12,x|7,y|12,y|
|5|yxtvuw|6,y|9,t|8,y|12,x|7,y|12,y|
|6|yxtvuwz|6,y|9,t|8,y|12,x|7,y|12,y|

f)

|step|$N^{'}$|D(x),p(x)|D(u),p(u)|D(v),p(v)|D(w),p(w)|D(y),p(y)|D(t),p(t)|
|-|-|-|-|-|-|-|-|
|0|z|8,z|$\infty$|$\infty$|$\infty$|12,z|$\infty$|
|1|zx|8,z|$\infty$|11,x|14,x|12,z|$\infty$|
|2|zxv|8,z|14,v|11,x|14,x|12,z|15,v|
|3|zxvy|8,z|14,v|11,x|14,x|12,z|15,v|
|4|zxvyu|8,z|14,v|11,x|14,x|12,z|15,v|
|5|zxvyuw|8,z|14,v|11,x|14,x|12,z|15,v|
|6|zxvyuwt|8,z|14,v|11,x|14,x|12,z|15,v|


P5、

||||值||||
|-|-|-|-|-|-|-|
|||u|v|x|y|z|
||v|$\infty$|$\infty$|$\infty$|$\infty$|$\infty$|
|从|x|$\infty$|$\infty$|$\infty$|$\infty$|$\infty$|
||z|$\infty$|6|2|$\infty$|0|

||||值||||
|-|-|-|-|-|-|-|
|||u|v|x|y|z|
||v|1|0|3|$\infty$|6|
|从|x|$\infty$|3|0|3|2|
||z|7|5|2|5|0|

||||值||||
|-|-|-|-|-|-|-|
|||u|v|x|y|z|
||v|1|0|3|3|5|
|从|x|4|3|0|3|2|
||z|6|5|2|5|0|

||||值||||
|-|-|-|-|-|-|-|
|||u|v|x|y|z|
||v|1|0|3|3|5|
|从|x|4|3|0|3|2|
||z|6|5|2|5|0|

P6、这个问题的措辞有点含糊。我们的意思是，“第一次运行算法时的迭代次数”(也就是说，假设节点最初拥有的唯一信息是其最近的邻居的成本)。我们假设该算法是同步运行的(即，在一个步骤中，所有节点同时计算它们的距离表，然后交换表)。

在每次迭代时，节点与其邻居交换距离表。因此，如果您是节点A，而您的邻居是B，则B的所有邻居(它们都是您的一两跳)在一次迭代后(即B告诉他们它对您的成本后)将知道一到两个跳到您的最短代价路径。

d是网络的“直径”--网络中任何两个节点之间最长的无环路路径的长度。使用上面的推理，经过d-1迭代后，所有节点都将知道d或更少跳到所有其他节点的最短路径代价。由于任何大于d跳的路径都会有循环(因此比去掉循环的路径花费更大)，该算法最多会在d-1迭代中收敛。

旁白：如果DV算法是由于链路成本的变化而运行的，则在收敛之前，所需迭代次数不存在先验界，除非还指定了链路成本的约束。

P7、

a)Dx(w) = 2, Dx(y) = 4, Dx(u) = 7 

b)首先考虑如果c(x，y)发生变化会发生什么。如果c(x，y)变大或变小(只要c(x，y)>=1)，那么从x到u的最小成本路径仍然至少要花费7。因此c(x，y)的改变(如果c(x，y)>=1)不会使x通知其邻居。

如果c(x，y)=$\sigma$<1，那么最小成本的路径现在通过y，并有成本$\sigma$+6。

现在考虑如果c(x，w)改变。如果c(x，w)=$\varepsilon$<=1，那么u的最小成本路径将继续通过w，其成本将更改为5+$\varepsilon$; x将通知它的邻居这个新的成本。如果c(x，w)=$\sigma$>6，那么最小成本路径现在经过y并花费了11；x将再次通知它的邻居这个新成本。

c)链路成本c(x，y)(以及只要c(x，y)>=1)中的任何更改都不会导致x通知其邻居关于u的新的最小成本路径。

P8、

结点x表

|||值|||
|-|-|-|-|-|
|||x|y|z|
||x|0|3|4|
|从|y|$\infty$|$\infty$|$\infty$|
||z|$\infty$|$\infty$|$\infty$|

|||值|||
|-|-|-|-|-|
|||x|y|z|
||x|0|3|4|
|从|y|3|0|6|
||z|4|6|0|

结点y表

|||值|||
|-|-|-|-|-|
|||x|y|z|
||x|$\infty$|$\infty$|$\infty$|
|从|y|3|0|6|
||z|$\infty$|$\infty$|$\infty$|

|||值|||
|-|-|-|-|-|
|||x|y|z|
||x|0|3|4|
|从|y|3|0|6|
||z|4|6|0|

结点z表

|||值|||
|-|-|-|-|-|
|||x|y|z|
||x|$\infty$|$\infty$|$\infty$|
|从|y|$\infty$|$\infty$|$\infty$|
||z|4|6|0|

|||值|||
|-|-|-|-|-|
|||x|y|z|
||x|0|3|4|
|从|y|3|0|6|
||z|4|6|0|

P9、不，这是因为降低链路成本不会导致循环(由该链路的两个节点之间的下一跳关系引起)。将两个节点连接到一个链路相当于将链路重量从无限降到有限权。

P10、在每一步中，节点距离向量的每一次更新都是基于Bellman-Ford方程，即只减少距离向量中的这些值。价值没有增加。如果没有更新，则不会发送消息。因此，D(X)是不增加的。由于这些代价是有限的，那么最终距离向量将稳定在有限的步骤。

P11、

a)
| | |
|-|-|
|Router z |Informs w, Dz(x)=$\infty$|
| |Informs y, Dz(x)=6 |
|Router w |Informs y, Dw(x)=$\infty$|
|| Informs z, Dw(x)=5 |
|Router y |Informs w, Dy(x)=4 |
|| Informs z, Dy(x)=4 |

b) 是的，会有一个数不胜数到无穷大的问题。下表显示了路由收敛过程。假设在t0时间发生链路成本更改。在时间T1，y更新其距离向量并通知邻居w和z。在下表中，“$\to$”表示“通知”。

|time |t0 |t1 |t2 |t3 |t4 |
|-----|---|---|---|---|---|
|Z | $\to$ w, Dz(x)=$\infty$||No change |$\to$ w, Dz(x)=$\infty$||
||$\to$y, Dz(x)=6|||$\to$y, Dz(x)=11 ||
|W|$\to$y, Dw(x)=$\infty$||$\to$y, Dw(x)=$\infty$| |No change |
||$\to$z,Dw(x)=5||$\to$z,Dw(x)=10 ||
|Y|$\to$w, Dy(x)=4 |$\to$w, Dy(x)=9 ||No change|$\to$w, Dy(x)=14 |
||$\to$z, Dy(x)=4 |$\to$z, Dy(x)=$\infty$|||$\to$z, Dy(x)=$\infty$|

我们看到w，y，z在计算路由器x的开销时形成一个循环。如果我们继续上面表中所示的迭代，那么在T27，z通过它与x的直接联系检测到它对x的最小成本是50。在T29，w通过z得知它对x的最小成本为51。在t30，y将其最小成本更新为52(通过w)。最后，在T31，没有更新，路由是稳定的。

|time |t27 |t28 |t29 |t30 |t31|
|-----|----|----|----|----|---|
|Z |$\to$w, Dz(x)=50 ||||via w, $\infty$|
||$\to$y, Dz(x)=50|||| via y, 55 |
||||||via z, 50 |
|W ||$\to$y, Dw(x)= |$\to$y, Dw(x)=51 ||via w, $\infty$|
||| $\to$z, Dw(x)=50 |$\to$z, Dw(x)= $\infty$ ||via y, $\infty$|
||||||via z, 51 |
|Y| |$\to$w, Dy(x)=53| |$\to$w, Dy(x)= $\infty$ |via w, 52 |
|| |$\to$z, Dy(x)= $\infty$ ||$\to$z, Dy(x)= 52 |via y, 60 |
||||||via z, 53 |

c)切断y和z之间的连接。

P12、由于在BGP、循环中从AS到目的地都提供了完整的路径信息检测是简单的-如果BGP对等体接收到包含自己的AS号的路由AS路径，然后使用该路由将导致环路。

P13、选择的路径不一定是最短的路径.回顾一下，在路线选择过程中有许多问题需要考虑。由于经济原因，较长的无环路路径很可能比较短的无环路路径更可取。例如，AS可能更愿意将流量发送给一个邻居，而不是另一个距离较短的邻居。

P14、

a) eBGP 

b) iBGP 

c) eBGP 

d) iBGP 


P15、

a）I1，因为这个接口开始从1D到网关路由器1c的最低成本路径。

(B)I2。这两种路由都有相等的路径长度，但I2开始的路径有最近的下一跳路由器。

(C)一.1。I1开始具有最短路径的路径。

P16、C迫使B在东海岸将所有B的流量移交给D的方法之一是C只在东海岸通过其东海岸凝视点登出其到D的路线。

P17、

![avater](./img/8.png)

在上述解决方案中，X不知道AC链路，因为X没有接收到包含AC链路的w或y的广告路由(即，X在到达目的地的路径上没有接收包含A和AS C的广告。

P18、BitTorrent文件共享和Skype P2P应用程序。考虑一个BitTorrent文件共享网络，其中对等点1、2和3分别位于存根网络W、X和Y中。由于BitTorrent的文件共享机制，使得Peer 2有可能从Peer 1中获取数据块，然后将这些数据块转发到3，这相当于最终被发送到存根网络Y的B转发数据。

P19、A应该建议B两条路线，A-W和A-V。

A应该只向C建议一条路线，A-V。

C作为路径接收：B-A-W、B-A-V、A-V。

P20、由于Z想要传输Y的流量，Z将以这种方式向Y发送路由广告。这样，当Y有一个发送到可以通过Z到达的IP的数据报时，Y将可以选择通过Z发送该数据报。但是，如果Z将路由转发到Y，Y可以将这些路由重登到X。因此，在这种情况下，Z无法阻止从X到Z的传输。

P21、请求响应模式通常会有更多的开销(以交换消息的数量来衡量)，原因有几个。首先，经理收到的每一条信息都需要两条消息：投票和响应。陷阱只向发送方生成一条消息。如果管理器只希望在发生条件时才得到通知，那么轮询的开销就会更大，因为许多轮询消息可能表明等待条件尚未发生。陷阱只在条件发生时生成消息。

在发生事件时，陷阱还会立即通知经理。使用轮询，管理器需要等待半个轮询周期(平均)，从事件发生到经理(通过其轮询消息)发现事件已经发生。

如果丢失了陷阱消息，托管设备将不会发送其他副本。如果一个投票消息或它的响应丢失了，经理就会知道已经丢失了一条消息(因为答复永远不会到达)。因此，如果需要，经理可以重新投票。

P22、通常，最需要网络管理的时间是在压力时，网络可能会严重拥挤，数据包正在丢失。在TCP上运行SNMP时，TCP的拥塞控制将导致SNMP在网络管理器需要发送SNMP消息时退出并停止发送消息。

[Back to Index](#目录)

# 第六章

## 复习题6 

R1、交通方式，如汽车、公共汽车、火车、汽车。

R2、虽然每个链路保证通过链路发送的IP数据报将在链路的另一端无错误地被接收，但不能保证IP数据报将以适当的顺序到达最终目的地。使用IP，同一TCP连接中的数据报可以在网络中采取不同的路由，从而导致出现故障。仍然需要TCP以正确的顺序向应用程序的接收端提供字节流。此外，IP可能由于路由循环或设备故障而丢失数据包。

R3、帧：IP和TCP中也有帧；链路访问；可靠传递：TCP中也有可靠的传递；流控制：TCP中也有流控制；错误检测：IP和TCP中也有错误检测；错误更正；全双工：TCP也是全双工。

R4、当一个节点正在发送时，它将开始从另一个节点接收一个分组，这将发生冲突。

R5、时隙ALOHA：1、2和4(时隙ALOHA仅部分分散，因为它要求所有节点中的时钟是同步的)。令牌环：1，2，3，4。

R6、在第5次碰撞之后，适配器从{0，1，2，…中选择，31。它选择4的概率是1/32。等待204.8微秒。

R7、在民意测验中，讨论领袖一次只允许一个参与者说话，每个参与者都有机会以一种循环的方式交谈。对于象征性的戒指，没有讨论的领导者，但有葡萄酒杯，参与者轮流持有。只有当参与者拿着酒杯时，才允许参与者说话。

R8、当节点发送帧时，节点必须等待帧在整个环周围传播，然后节点才能释放令牌。因此，如果L/R比tprop小，那么协议就会效率低下。

R9、$2^{48}$个MAC地址；$2^{32}$个IPv4地址；$2^{128}$个IPv6地址。

R10、C的适配器将处理这些帧，但是适配器不会将数据报传递到协议栈中。如果使用LAN广播地址，则C的适配器将处理帧并将数据报传递到协议栈。

R11、在广播帧中发送ARP查询，因为查询主机没有将哪个适配器地址对应于所述IP地址。对于响应，发送节点知道应该将响应发送到的适配器地址，因此不需要发送广播帧(必须由LAN上的所有其他节点处理)。

R12、不可能。每个LAN都有自己的一组不同的适配器，每个适配器都有一个唯一的LAN地址。

R13、这三种以太网技术具有相同的帧结构。

R14、2(内部子网和外部因特网)

R15、在802.1Q中有一个12位的VLAN标识符。因此，可以支持212=4096个VLAN。

R16、我们可以把N个开关串在一起。第一个也是最后一个交换机将使用一个端口进行中继；中间的N-2交换机将使用两个端口。因此，端口总数为2+2(N-2)=2N-2端口。

[Back to Index](#目录)

## 问题6 

P1、

1 1 1 0 1 

0 1 1 0 0 

1 0 0 1 0 

1 1 0 1 1 

1 1 0 0 0 

P2、假设我们从初始的二维奇偶矩阵开始：

0 0 0 0 

1 1 1 1 

0 1 0 1 

1 0 1 0 

由于在第2行第3栏中出现了一些错误，第2行和第3列的奇偶校验现在在下面的矩阵中是错误的：

0 0 0 0 

1 1 0 1 

0 1 0 1 

1 0 1 0 

现在假设第2行、第2列和第3列有一个位错误。第2行的奇偶校验现在是正确的！列2和3的奇偶校验是错误的，但是我们不能检测错误发生在哪一行！

0 0 0 0

1 0 0 1 

0 1 0 1 

1 0 1 0 

上述示例显示，可以检测到双比特错误(如果没有纠正)。

P3、
```
  01001100 01101001 
+ 01101110 01101011 
------------------------------ 
  10111010 11010100 
+ 00100000 01001100 
------------------------------ 
  11011011 00100000 
+ 01100001 01111001
----------------------------- 
  00111100 10011010 (溢出，然后绕过去) 
+ 01100101 01110010 
------------------------------ 
  10100010 00001100 
```
和的补码是： 01011101 11110011 

P4、

a) 要计算网络检验值，我们将16位量的值加起来： 
```
 00000001 00000010 
 00000011 00000100 
 00000101 00000110 
 00000111 00001000 
 00001001 00001010 
 ------------------------- 
 00011001 00011110 
```
和补码为：11100110 11100001. 
b) 要计算网络检验值，我们将16位量的值加起来： 
```
01000010 01000011 
01000100 01000101 
01000110 01000111 
01001000 01001001 
01001010 01001011 
------------------------- 
10011111 10100100 
```
和补码为：01100000 01011011 

c) 要计算网络检验值，我们将16位量的值加起来
```
01100010 01100011 
01100100 01100101 
01100110 01100111 
01101000 01101001 
01101010 01101011 
------------------------- 
00000000 00000101 
```
和补码为：11111111 11111010.


P5、如果我们将10011分为1010101010 0000，我们可以得到1011011100，剩余R=0100。注意G=10011是CRC-4-ITU标准。 

P6、

a)我们得到1000110000，剩余R=0000。

b)我们得到0101010101，剩余R=1111. 

c)我们得到1011010111，剩余R=1001. 


P7、

(A)在不失去通用性的情况下，假设ith位被翻转，其中0<= i <= d+r-1 并假设最不重要的位是第0位。单比特错误意味着接收到的数据为K=D*2R XOR R2 i。很明显，如果我们把K除以G，那么提醒不是零。通常情况下，如果G包含至少两个1，则总是可以检测到单个比特错误。

(B)这里的关键洞见是G可以被11(二进制数)除以，但任何奇数的1‘s不能除以11。因此，奇数位错误的序列(不一定是连续的)不能除以11，因此不能被G除以G。

P8、

a)

$E(p)=NP(1-p)^{N-1}$

$E'(p)=N(1-p)^{N-1}-Np(N-1)(1-p)^{N-2}=N(1-p)^{N-2}((1-p)-p(N-1))$

b) 

$E(p^\ast )=N\frac{1}{N}(1-\frac{1}{N})^{N-1}=(1-\frac{1}{N})^{N-1}=\frac{(1-\frac{1}{N})^N}{1-\frac{1}{N}}$

$\lim_{N \to \infty }(1-\frac{1}{N})=1$

$\lim_{N \to \infty }(1-\frac{1}{N})^N=\frac{1}{e}$

因此

$\lim_{N \to \infty }E(p^\ast )=\frac{1}{e}$

P9、

$E(p)=NP(1-p)^{2(N-1)}$

$E'(p)=N(1-p)^{2(N-1)}-Np2(N-1)(1-p)^{2(N-3)}=N(1-p)^{2(N-3)}((1-p)-p2(N-1))$

$E'(p)=0\Rightarrow p^*=\frac{1}{2N-1}$

$E(p^*)=\frac{N}{2N-1}(1-\frac{1}{2N-1})^{2(N-1)}$

$\lim_{N \to \infty }E(p^*)=\frac{1}{2}\cdot \frac{1}{e}=\frac{1}{2e}$

P10、
a)A的平均吞吐量由Pa(1-PB)给出.总效率为Pa(1-PB)PB(1-Pa).

(B)A的吞吐量为Pa(1-PB)=2PB(1-PB)=2PB-2(PB)2，B的吞吐量为PB(1-Pa)=PB(1-2PB)=PB-2(PB)2，很明显，A的吞吐量不是B的两倍，为了使PA(1-PB)=2PB(1-Pa)，我们需要PA=2-(Pa/PB)。

(C)A的吞吐量为2p(1-p)N1，任何其他节点的吞吐量p(1-p)N-2(1-2p)。

P11、

a) (1 – p(A))4 p(A) 

其中p(A) = A在一个槽中成功的概率 

 p(A) = p(A传输并且B不传输并且C不传输并且D不传输) = p(A传输) p(B不传输) p(C不传输) p(D不传输) = p(1 – p) (1 – p)(1-p) = p(1 – p)3 

因此， p(A第一次在5号槽成功) = (1 – p(A))4 p(A) = (1 – p(1 – p)3)4 p(1 – p)3 

b) p(A在4槽中成功) = p(1-p)3 

p(B在4槽中成功) = p(1-p)3 

p(C在4槽中成功) = p(1-p)3 

p(D在4槽中成功) = p(1-p)3 

p(要么A或者B或者C或者D在4号槽中成功) = 4 p(1-p)3 (因为这些事件是相互排斥的) 

c) p(一些结点在一个槽中成功) = 4 p(1-p)3 

p(一个槽中没有结点成功) = 1 - 4 p(1-p)3

因此，p(第一个成功发生在3槽) = p(没有结点在前2个槽中成功) p(一些结点在第三个槽中成功) = (1 - 4 p(1-p)3)2 4 p(1-p)3 

d) 效率 = p(在一个槽中成功) =4 p(1-p)3 


P12、

![avater](./img/7.png)

![avater](./img/6.png)

P13、轮询轮的长度为：

$N(Q/R+d_{poll})$

在轮询轮中传输的比特数是NQ。因此，最大吞吐量是:

$\frac{NQ}{N(Q/R+d_{poll})}=\frac{R}{1+\frac{d_{poll}R}{Q}}$

P14、a）b）见下图：

![avater](./img/5.png)

c）
1.E中的转发表确定数据报应路由到接口192.168.3.002。

2.E中的适配器创建具有以太网目的地地址88-88-88-88-88-88-88的以太网数据包。

3.路由器2接收数据包并提取数据报。此路由器中的转发表指示数据报将被路由到198.162.2.002。

4.路由器2然后通过其与IP地址198.162.003的接口发送目的地址为33-33-33-33-33-33-33-33和源地址为55-55-55-55-55-55-55-55-55-55的以太网分组。

5.这一过程一直持续到数据包到达主机B为止。

(D)E中的ARP现在必须确定198.162.3.002的MAC地址。主机E在广播以太网帧内发送ARP查询包。路由器2接收查询包并向主机E发送ARP响应包。此ARP响应包由以太网帧承载，以太网目的地地址为77-77-77-77-77-77-77-77。

P15、(A)否。E可以检查主机F的IP地址的子网前缀，然后了解F在同一个局域网上。因此，E不会将数据包发送到默认路由器R1。

从E到F的以太网帧：

源IP=E的IP地址

目的地IP=F的IP地址

源MAC=E的MAC地址

目的地MAC=F的MAC地址

b)不，因为它们不在同一个局域网上。E可以通过检查B的IP地址来发现这一点。

从E到R1的以太网帧：

源IP=E的IP地址

目的地IP=B的IP地址

源MAC=E的MAC地址

目的地MAC=连接到子网的R1接口的MAC地址。

c)交换机S1将通过两个接口广播以太网帧，因为接收到的ARP帧的目的地地址是广播地址。它了解到A驻留在连接到子网1的子网1上，并且S1将更新它的转发表以包括主机A的条目。

是的，路由器R1也接收这个ARP请求消息，但是R1不会将消息转发到子网3。

B不会发送请求A的MAC地址的ARP查询消息，因为这个地址可以从A的查询消息中获得。

一旦交换机S1接收到B的响应消息，它将在其转发表中为主机B添加一个条目，然后删除接收到的帧，因为目的地主机A与主机B在同一个接口上(即A和B位于同一个LAN段上)。

P16、让我们称子网2和3s2之间的切换为S2。也就是说，子网2和3之间的路由器R1现在被交换机S2所取代。

(A)否。E可以检查主机F的IP地址的子网前缀，然后了解F在同一个LAN段上。因此，E不会将数据包发送到S2。

从E到F的以太网帧：

源IP=E的IP地址

目的地IP=F的IP地址

源MAC=E的MAC地址

目的地MAC=F的MAC地址

b）是的，因为E想找到B的MAC地址。在这种情况下，E将发送一个ARP查询包，目标MAC地址是广播地址。

该查询包将由交换机1重新广播，最终由主机B。

以太网帧从E接收到S2：

源IP=E的IP地址

目的地IP=B的IP地址

源MAC=E的MAC地址

目的地MAC=广播MAC地址：FF-FF-FF-FF-FF-FF。

(C)交换机S1将通过两个接口广播以太网帧，因为接收到的ARP帧的目标地址是广播地址。它了解到A驻留在连接到子网1的子网1上，并且S1将更新它的转发表以包括主机A的条目。

是的，路由器S2也接收这个ARP请求消息，S2将这个查询包广播到它的所有接口。

B不会发送请求A的MAC地址的ARP查询消息，因为这个地址可以从A的查询消息中获得。

一旦交换机S1接收到B的响应消息，它将在其转发表中为主机B添加一个条目，然后删除接收到的帧，因为目的地主机A与主机B在同一个接口上(即A和B位于同一个LAN段上)。

P17、等待51200比特时间。对于10 Mbps，这个等待是

$\frac{51.2\times 10^3 bits}{10\times 10^6 bps}=5.12ms$

对于100Mbps，等待时间是512$\mu s$

P18、在t=0时A发射。在t=576时，A将完成传输。在最坏的情况下，B在时间t=324开始发送，即A的第一个帧到达B之前的时间。在时间t=324+325=649时 B的第一个比特到达A时，A在检测到B已经发送之前就完成了传输，所以A错误地认为它的帧在没有碰撞的情况下被成功地传输了。

P19、

|时间，t|事件|
|------|---|
|0|A和B开始传输|
|245|A和B检测碰撞|
|293|A和B结束拥塞信号传输|
|293+245=538|B的最后一比特到达A；A检测空闲线路|
|538+96=634|A开始传输|
|293+512=805|B返回到第二步|
||B必须对空闲信道进行96 bit的检测，然后才能传输。|
|634+245=879|A的传送到达B|

由于A的重传在B的预定重传时间(805+96)之前到达B，所以B在A重传时不进行传输，因此A和B不发生碰撞，因此指数退避算法中出现的因子512足够大。

P20、

a）设Y是表示插槽数目的随机变量，直到成功：

$P\left ( Y=m \right )=\beta \left ( 1-\beta \right )^{m-1}$

$\beta$表示成功的概率。

这是一个几何分布，它的平均值为$1/\beta$。连续浪费的插槽数为X=Y-1 其中

$x=E[X]=E[Y]-1=\frac{1-\beta}{\beta}$

$\beta = Np\left ( 1-p \right )^{N-1}$

$x=\frac{1-Np(1-p)^{N-1}}{Np(1-p)^{N-1}}=\frac{k}{k+x}=\frac{k}{k+\frac{1-Np(1-p)^{N-1}}{Np(1-p)^{N-1}}}$

效率

b）最大化效率等同于最小化x，这相当于最大化$\beta$。我们从文本中得知，$\beta$在$p=\frac{1}{N}$处是最大的。

c）效率=$\frac{k}{k+\frac{1-(1-\frac{1}{N})^{N-1}}{(1-\frac{1}{N})^{N-1}}}$

$\lim_{N \to\infty } efficiency =\frac{k}{k+\frac{1-1/e}{1/e}}=\frac{k}{k+e-1}$

d）显然，当k趋近于无穷时$\frac{k}{k+e-1}$趋近于1。

P21、

![avater](./img/4.png)

i) 从A到右路由器：

   源MAC地址：00-00-00-00-00-00 

   目的地MAC地址：22-22-22-22-22-22 

   源IP：111.111.111.001 

   目的地IP：133.333.333.003 

ii) 从交换机到右路由器：

   源MAC地址：33-33-33-33-33-33

   目的地MAC地址: 55-55-55-55-55-55 

   源IP: 111.111.111.001 

   目的地IP: 133.333.333.003 

iii) 从右路由器到F：

   源MAC地址: 88-88-88-88-88-88 

   目的地MAC地址: 99-99-99-99-99-99 

   源IP: 111.111.111.001 

   目的地IP: 133.333.333.003


P22、
i) 从A到交换机：

   源MAC地址：00-00-00-00-00-00 

   目的地MAC地址：55-55-55-55-55-55 

   源IP：111.111.111.001 

   目的地IP：133.333.333.003 

ii) 从交换机到右路由器：

   源MAC地址：00-00-00-00-00-00

   目的地MAC地址: 55-55-55-55-55-55 

   源IP: 111.111.111.001 

   目的地IP: 133.333.333.003 

iii) 从右路由器到F：

   源MAC地址: 88-88-88-88-88-88 

   目的地MAC地址: 99-99-99-99-99-99 

   源IP: 111.111.111.001 

   目的地IP: 133.333.333.003 


P23、如果所有11=9.2节点以100 Mbps的最大可能速率发送数据，则总总吞吐量为11*100=1100 Mbps是可能的。

P24、每个部门中心都是一个冲突域，最大吞吐量为100 Mbps。连接Web服务器和邮件服务器的链接的最大吞吐量为100 Mbps。因此，如果三个碰撞域以及Web服务器和邮件服务器以各自100 Mbps的最大可能速率发送数据，则11端系统之间的总总吞吐量可达到500 Mbps。

P25、所有的11端系统都将处于相同的碰撞域。在这种情况下，在11端系统中，最大总吞吐量为100 Mbps是可能的。

P26、

|行为|开关表状态|链路包前往|解释|
|---|---------|--------|---|
|B发送一帧给E|与B的MAC地址对应的交换机学习接口|A,C,D,E,F|由于交换机表是空的，所以交换机不知道与E的MAC地址对应的接口|
|E发送一帧给B|与E的MAC地址对应的交换机学习接口|B|由于交换机已经知道与B的MAC地址对应的接口|
|A发送一帧给B|与A的MAC地址对应的交换机学习接口|B|由于交换机已经知道与B的MAC地址对应的接口|
|B发送一帧给A|切换表状态与以前相同。|A|由于交换机已经知道与A的MAC地址对应的接口|

P27、

a）填充$L\cdot8$ bits需要的时间是：

$\frac{L\cdot8}{128\times 10^3 } sec = \frac{L}{16}ms$

b）对于L=1500，包化延迟为：

$\frac{1500}{16}ms=93.75 ms$

对于L=50，包化延迟为：

$\frac{50}{16}ms=3.125 ms$

c）存储和转发延迟为$\frac{L \cdot 8+40}{R}$

对于L=1500，延迟为

$\frac{1500\cdot 8+40}{622\times 10^{6}} sec \approx 19.4 \mu s$

对于L=50，存储和转发延迟<1微秒。

d）对于典型的链路速度，存储和转发延迟对于这两种情况都是很小的.然而，L=1500的分组化延迟对于实时语音应用来说太大了.

P28、EE部门这三台计算机(从左到右)的IP地址是：111.111.1.1、111.111.1.2、111.111.1.3。子网掩码为111.111.1/24。

CS部门这三台计算机(从左到右)的IP地址是：111.111.2.1、111.111.2.2、111.111.2.3。子网掩码为111.111.2/24。

连接到端口1的路由器接口卡可以配置为包含两个子接口IP地址：111.111.1.0和111.111.2.0。第一种是针对EE部门的子网，第二种是针对CS部门的子网。每个IP地址都与VLAN ID相关联。假设111.111.1.0与VLAN 11相关联，111.111.2.0与VLAN 12相关联。这意味着来自子网111.111.1/24的每一帧将被添加一个带有VLAN ID 11的802.1q标记，而来自111.111.2/24的每一帧将被添加一个带有VLAN ID 12的802.1q标记。

假设EE部门中具有IP地址111.111.1.1的主机A希望向CS部门中的主机B(111.111.2.1)发送IP数据报。主机A首先将IP数据报(目的地为111.111.2.1)封装到具有与连接到交换机端口1的路由器接口卡的MAC地址相等的目标MAC地址的帧中。一旦路由器接收到该帧，然后将其传递到IP层，该层决定通过子接口111.111.2.0将IP数据报转发到子网111.111.2/24。然后路由器将IP数据报封装成一个帧并发送到端口1。请注意，该帧有一个802.1q标记VLAN ID 12。一旦交换机接收到帧端口1，它就知道该帧被发送到ID为12的VLAN，因此交换机将该帧发送到位于CS部门的主机B。一旦主机B接收到此帧，它将删除802.1q标记。

P29、

![avater](./img/3.png)

P30、

![avater](./img/2.png)

P31、(下面的说明很简短，但包含了所有主要的关键步骤和涉及的关键协议。)

您的计算机首先使用DHCP获取IP地址。您的计算机首先在DHCP服务器发现步骤中创建一个指定为255.255.255.255的特殊IP数据报，并将其放在以太网帧中并在以太网中广播。然后，按照DHCP协议中的步骤，您的计算机能够获得具有给定租约时间的IP地址。

以太网上的DHCP服务器还为计算机提供了第一跳路由器的IP地址列表、计算机所在子网的子网掩码以及本地DNS服务器的地址(如果存在的话)。

由于您的计算机的ARP缓存最初是空的，您的计算机将使用ARP协议来获取第一跳路由器和本地DNS服务器的MAC地址。

您的计算机将首先获得您想要下载的网页的IP地址。如果本地DNS服务器没有IP地址，则计算机将使用DNS协议查找网页的IP地址。

一旦计算机拥有了网页的IP地址，如果网页不驻留在本地Web服务器中，它将通过第一跳路由器发送HTTP请求。HTTP请求消息将被分割并封装到TCP数据包中，然后进一步封装到IP数据包中，最后封装到以太网帧中。您的计算机将以太网帧发送到第一跳路由器.一旦路由器接收到这些帧，就会将它们传递到IP层，检查其路由表，然后将数据包从所有接口发送到正确的接口。

然后，您的IP包将通过互联网路由，直到它们到达Web服务器。

承载网页的服务器将通过HTTP响应消息将网页发送回计算机。这些消息将被封装到TCP数据包中，然后进一步封装到IP数据包中。这些IP数据包遵循IP路由，最终到达第一跳路由器，然后路由器将这些IP数据包封装到以太网帧中，将它们转发到计算机上。

P32、

A)每个流均匀分布一个链路的容量，然后80个流通过B到接入路由器10Gbps链路（以及接入路由器到边界路由器链路），每个都将仅接收10Gbps/80=125Mbps

b)在图5.31的拓扑中，第一层和第三层2交换机之间有四个不同的路径，一起为从机架14到机架912的流量提供40Gbps。类似地，第二层和第四层2交换机之间有四个链路，一起为来自机架58到1316的业务提供40Gbps。因此，总的总带宽是80Gbps，并且每个流速的值是1Gbps。

c)现在20个流量需要在TOR交换机对之间共享每1Gbps带宽。因此，主机到主机的比特率将为0.5Gbps。

P33、

a）电子邮件和视频应用程序使用第四个机架占时间的0.1%。

b）两个应用需要第四机架的概率为0.001*0.001=10-6.

c）假设前三个机架是用于视频的，下一个机架是用于两个机架的共享机架视频和电子邮件，接下来的三个机架用于电子邮件。我们假设第四个机架拥有电子邮件和视频应用程序所需的所有数据和软件。使用图5.31的拓扑，两个应用程序都具有足够的带宽内带宽只要两者都不同时使用第四机架。从B部分，均为：使用第四个机架不超过.00001%的时间，该时间在.0001%以内要求。

[Back to Index](#目录)

# 第七章

## 复习题7 

1、在基础设施模式的操作，每一个无线主机都通过一个基站（接入点）连接到更大的网络。如果不是在基础模式操作，网络以ad-hoc模式操作。在ad-hoc模式下，无线主机没有可连接的基础设施。在缺少基础设施的情况下，主机必须自己提供如路由器、地址分配、DNS类似名称翻译和更多的服务。

2、a）单点，基于设备

b）单点，缺少设备

c）多点，基于设备

d）多点，缺少设备

3、路径损耗是由于电磁信号在物质中传播时的衰减所致。多径传播导致接收端接收信号模糊，当电磁波部分反射物体和地面时，在发送者和接收者之间选择不同长度的路径时发生。当另一个源也在与无线网络相同的频率范围内发送时，来自其他源的干扰发生。

4、

a）增加传输功率

b）降低传输率

5、AP发射信标帧。AP的信标帧将通过11个信道中的一个进行传输。信标帧允许附近的无线站发现和识别AP。

6、假

7、AP发射信标帧。AP的信标帧将通过11个信道中的一个进行传输。信标帧允许附近的无线站发现和识别AP。

8、假

9、每个无线站可以设置RTS阈值，使RTS/CTS序列仅在要发送的数据帧大于阈值时使用。这确保RTS/CTS机制仅用于大帧。

10、不，不会有什么好处的。假设有两个站同时发送，它们都使用RTS/CTS。如果RTS帧与数据帧一样长，则只要信道被浪费在两个冲突的数据帧上，信道就会被浪费。因此，只有当RTS/CTS帧明显小于数据帧时，RTS/CTS交换才是有用的。

11、最初，交换机在其转发表中有一个条目，该条目将无线站与较早的AP相关联。当无线站与新AP相关联时，新AP创建具有无线电台MAC地址的帧并广播该帧。该帧由交换机接收。这迫使交换机更新其转发表，以便通过新的AP发送发送到无线站的帧。

12、任何普通的蓝牙节点都可以是主节点，而802.11网络中的接入点是特殊的设备(普通的无线设备，如膝上型计算机，不能用作接入点)。

13、假

14、“机会主义调度”是指将物理层协议与发送方和接收方之间的信道条件相匹配，并根据信道条件选择要发送数据包的接收方。这使得基站能够充分利用无线媒体。

15、UMTS对于GSM和CDMA-2000对与IS-95.

16、eNodeB的数据平面作用是在UE(通过LTE无线接入网)和P-GW之间转发数据报。它的控制平面作用是代表UE处理注册和移动信令业务。

移动管理实体(MME)代表驻留在其控制单元中的ue执行连接和移动管理。它从HHS接收UE订阅信息。

分组数据网络网关(P-GW)将IP地址分配给UE并执行QoS强制执行。作为隧道端点，它还在向UE转发数据报时执行数据报封装/解封装。

服务网关(S-GW)是数据平面移动锚点，因为所有UE业务都将通过S-GW.S-GW还执行收费/计费功能和合法的流量拦截。

17、在3G体系结构中，话音和数据有独立的网络组件和路径，即话音通过公用电话网络，而数据通过公共互联网。4G体系结构是一个统一的全IP网络体系结构，即语音和数据在IP数据报中传送到或从无线设备传送到多个网关，然后传送到因特网的其他部分。

4G网络体系结构将数据和控制平面清晰地分开，这与3G体系结构不同。

4G架构有一个增强的无线接入网(E-UTRAN)，它不同于3G的无线接入网UTRAN。

18、没有。在连接到Internet的整个过程中，节点可以保持与同一接入点的连接(因此，不能移动)。移动节点是随着时间的推移将其连接点转换为网络的节点。由于用户总是通过同一个接入点访问Internet，所以她不能移动。

19、移动节点的永久地址是其在家庭网络中的IP地址。地址的关心是它在访问外国网络时得到的地址.COA由外部代理(可以是外部网络中的边缘路由器或移动节点本身)分配。

20、假

21、GSM中的家庭网络维护一个称为归属位置寄存器的数据库(HLR)，其包含永久单元电话号码和用户简档关于其每个用户的信息。HLR还包含关于这些用户的当前位置。被访问的网络维护一个数据库称为访问位置寄存器(VLR)，其包含每个移动台的条目当前位于由VLR服务的网络部分中的用户。VLR条目因此，当移动用户进入并离开网络时，进入并进入。

移动IP中归属网络中的边缘路由器与GSM中的HLR和GSM中的HLR类似,国外网络中的边缘路由器与GSM中的VLR类似。

22、锚MSC是在第一次呼叫开始时由移动访问的MSC；因此，锚MSC在呼叫期间保持不变。在整个呼叫持续时间内，无论由移动执行的MSC间传输的次数如何，呼叫都是从家乡MSC路由到锚MSC，然后从锚MSC路由到当前移动位置所在的已访问MSC。

23、

a）本地恢复

b）TCP发送方对无线链路的感知

c）拆分连接方法

[Back to Index](#目录)

## 问题7 

P1、
位d1对应的输出 = [-1,1,-1,1,-1,1,-1,1]

位d0对应的输出= [1,-1,1,-1,1,-1,1,-1] 

P2、
发送方2输出为：

   [1,-1,1,1,1,-1,1,1]
   [1,-1,1,1,1,-1,1,1] 

P3、

$d_{2}^{1}=\frac{1 \times 1+(-1)\times(-1)+1 \times 1+1 \times 1+1 \times 1+(-1)\times(-1)+1\times1+1\times1}{8}=1$

$d_{2}^{2}=\frac{1 \times 1+(-1)\times(-1)+1 \times 1+1 \times 1+1 \times 1+(-1)\times(-1)+1\times1+1\times1}{8}=1$


P4、
   发送方 1: (1, 1, 1, -1, 1, -1, -1, -1) 

   发送方 2: (1, -1, 1, 1, 1, 1, 1, 1) 


P5、a）两个AP通常具有不同的SSID和MAC地址。无线到达CAFTA的站将与其中一个SSID（即，其中一个AP）相关联。在关联之后，在新站点和AP之间存在虚拟链路。标记AP1和AP2。假设新站点与AP1相关联。当新的站发送帧，它将被寻址到AP1。尽管AP2还将接收帧，因为帧未被寻址，所以它将不处理帧。是的。因此，两个ISP可以在同一信道上并行工作。然而,这两个ISP将共享相同的无线带宽。如果不同的无线站不同ISP同时发送，会发生冲突。对于802.11b，最大值两个ISP的聚合传输速率为11Mbps。

b）现在，如果不同ISP（以及因此不同的信道）中的两个无线站发送同时，不会发生碰撞。因此,最大骨料对于802.11b，两个ISP的传输速率为22Mbps。

P6、假设无线站h1有1000个长帧要发送。(h1可能是将MP3转发到其他无线电台的AP。)假设最初h1是唯一想要传输的站，但是在传输其第一个帧的中途，h2想发送一个帧。为了简单起见，也假设每个站都能听到其他站的信号(也就是说，没有隐藏的终端)。在传输之前，H2将感觉到信道是繁忙的，因此选择一个随机的退避值。

现在假设在发送第一个帧之后，h1返回到步骤1；也就是说，它等待一个短时间(DIFS)，然后开始发送第二个帧。h1的第二帧将被传输，而h2被卡在退避中，等待空闲信道。因此，h1应该能够在h2有机会访问信道之前传输其所有1000帧。另一方面，如果h1在发送帧后进入步骤2，那么它也会选择一个随机的退避值，从而给h2一个公平的机会。因此，公平是这种设计选择的理由。

P7、没有数据的帧有32个字节长。假设传输速率为11 Mbps，发送控制帧(例如RTS帧、CTS帧或ACK帧)的时间为(256 bits)/(11 Mbps)=23 USEC。传输数据帧所需的时间为(8256 bits)/(11 Mbps)=751

P8、a) 1 message/ 2 slots 

b) 2 messages/slot 

c) 1 message/slot 

d)
   i) 1 message/slot 

   ii) 2 messages/slot 

   iii) 2 messages/slot 

e) 

   i) 1 message/4 slots 

   ii)

   slot 1: Message A→ B, message D→ C 

   slot 2: Ack B→ A 

   slot 3: Ack C→ D 

   = 2 messages/ 3 slots 

iii) 

   slot 1: Message C→ D 

   slot 2: Ack D→C, message A→ B 

   slot 3: Ack B→ A 

   = 2 messages/3 slots

P10、a）如果只向节点A发送10 Mbps，则此解决方案不公平，因为只有A正在得到服务。所谓“公平”，意味着四个节点中的每一个都应该分配相同数量的插槽。

(B)对于公平性要求，使每个节点在每个下游子帧期间接收相等数量的数据，让n1、n2、n3和n4分别表示A、B、C和D所得到的时隙数。

现在，在1时隙中发送给A的数据=10 tMbit(假设每个时隙的持续时间为t)，

因此，发送给A(在N1时隙中)的总数据量=10tN1，

同样地，发送给B、C和D的数据总量分别等于5tN2、2.5tn3和tN4。

现在，为了满足既定的公平要求，我们有以下条件：

10t n1 = 5t n2 = 2.5t n3 = t n4 

因此 
   n2 = 2 n1 

   n3 = 4 n1 

   n4 = 10 n1 

现在， 槽的总数是N。因此， 

   n1+ n2+ n3+ n4 = N 

   i.e. n1+ 2 n1 + 4 n1 + 10 n1 = N 

   i.e. n1 = N/17 

因此， 
   n2 = 2N/17 

   n3 = 4N/17 

   n4 = 10N/17 

平均传输速率为： 
   (10t n1+5t n2+ 2.5t n3+t n4)/tN 

   = (10N/17 + 5 * 2N/17 + 2.5 * 4N/17 + 1 * 10N/17)/N 

   = 40/17 = 2.35 Mbps 

c）在子帧中，节点A接收的数据是节点B、C和D的两倍。因此，

 10tn1 = 2 * 5tn2 = 2 * 2.5tn3 = 2 * tn4 

 i.e. n2 = n1 

 n3 = 2n1 

 n4 = 5n1 

同样的， 

 n1 + n2 + n3 + n4 = N 

 i.e. n 1+ n1 + 2n1 + 5n1 = N 

 i.e. n1 = N/9 

平均传输速率是： 

 (10t n1+5t n2+ 2.5t n3+t n4)/tN 

 = 25/9 = 2.78 Mbps 

同样，考虑节点B、C或D接收的数据是任何其他节点的两倍，可以计算平均传输速率的不同值。

P11、（A）否。所有路由器可能无法立即路由数据报。这是因为距离向量算法（以及AS之间的路由协议，如是分散的，需要一些时间来终止。所以，在这段时间算法仍在运行，因为广告来自新的外国网络，一些路由器可能无法将数据报路由到移动节点。
（B）是。当其中一个节点刚刚离开一个外国网络时可能会发生这种情况加入了一个新的外国网络。在这种情况下，从旧的路由条目外国网络可能没有完全撤回时，从新的网络正在被传播。
（C）路由器学习移动节点路径所需的时间取决于的路由器和边缘路由器之间的跳数节点。

P12、

![avater](./img/1.png)

如果通讯员是可移动的，那么发送给记者的任何数据报都必须通过通讯员的家庭代理。访问的网络中的外国代理也需要参与，因为正是该外国代理将通讯员的位置通知通讯员的本国代理。记者的本地代理接收到的数据报需要在通讯员的本地代理和外部代理之间封装/隧道化(如图6.23顶部的封装图所示)。

P13、因为数据报必须首先转发给归属代理，并且从那里转发到移动设备，所以延迟通常将比通过直接路由更长。但是，可能的是，从通信方到移动设备的直接延迟(即，如果数据报没有通过归属代理路由)实际上可以小于从通信方到归属代理和从那里到移动设备的延迟的总和。这取决于这些不同路径段的延迟。注意，间接路由还增加了归属代理处理(例如，封装)延迟。

P14、首先，我们注意到在第6.5节末尾讨论了链接。在使用通过归属代理的间接路由进行链接的情况下，将发生以下事件：
- 移动节点到达A，A通知归属代理移动正在访问A，移动到移动端的数据报现在应该被转发到A中指定的注意地址(COA)。
- 移动节点移动到B。B处的外国代理必须通知A处的外国代理，该移动设备已不在A中，但实际上是在B中，并且在B中有指定的COA。从那时起，A中的外国代理将接收到的数据报发送到A中的移动COA到B中的移动COA。
- 移动节点移动到C。C处的外国代理必须通知B处的外国代理，该移动设备已不在B中，但实际上是C中的C，并且在C中具有指定的COA。从那时起，B中的外国代理将它收到的(从A中的外国代理接收的)发送到移动台B中的COA的数据报转发到移动的C中的COA。

请注意，当移动设备离线(即，没有地址)或返回到其家乡网络时，必须删除由A、B和C中的外国代理维护的数据报转发状态。这种拆卸也必须通过信令消息来完成。请注意，本地代理不知道移动设备的移动性超过A，并且通讯员根本不知道移动设备的移动性。

在不使用链接的情况下，将发生以下事件：
- 移动节点到达A，A通知归属代理移动正在访问A，移动到移动端的数据报现在应该被转发到A中指定的注意地址(COA)。
- 移动节点移动到B。B处的外国代理必须通知A处的外国代理和本地代理，移动台已不再是A中的居民，但实际上是在B中，并且在B中有指定的COA。A中的外国代理可以移除其关于移动的状态，因为它不再在A中，因此本地代理将转发它在B中收到的发送到移动的COA的数据报。
- 移动节点移动到C。C处的外国代理必须通知B处的外国代理和本地代理，移动台已不再是B中的居民，但实际上是C中的C，并且在C中有指定的COA。B中的外国代理可以移除其关于移动的状态，因为它不再在B中。从那时起，本地代理将转发它在C中收到的发送到移动的COA的数据报。

当移动设备离线或返回其家庭网络时，必须移除外国代理在C中维护的数据报转发状态。这种拆卸也必须通过信令消息来完成。请注意，本地代理总是知道移动当前的外部网络。然而，记者仍然幸灾乐祸地不知道手机的移动性。

P15、在同一个访问网络中，两个移动电话的地址肯定是相同的。事实上，如果地址是外国代理人的地址，那么这个地址也是一样的.一旦外国代理解封装隧道数据报并确定移动地址，则需要使用单独的地址将数据报分别发送到访问网络中的不同目的地(手机)。

P16、如果向HLR提供了MSRN，则当MSRN发生变化时(例如，当切换要求MSRN改变时)，必须在HLR中更新MSRN的值。在HLR中拥有MSRN的优点是可以快速提供值，而无需查询VLR。通过提供VLR而不是MSRN的地址，无需刷新HLR中的MSRN。

[Back to Index](#目录)